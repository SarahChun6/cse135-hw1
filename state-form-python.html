<!DOCTYPE html>
<html lang="en">
    <head>
    <meta charset="UTF-8">
    <title>Python Session State Demo</title>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-EMRPHRTRC5"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-EMRPHRTRC5');
    </script>
</head>
<body>

<h1>Python Session State Demo</h1>

<nav>
  <a href="/cgi-bin/python/session-form.py?action=save">Save Form Data</a> |
  <a href="/cgi-bin/python/session-form.py?action=view">View Saved Data</a> |
  <a href="/cgi-bin/python/session-form.py?action=clear" onclick="return confirm('Are you sure you want to clear all sessions?')">Clear All Sessions</a>
</nav>
<hr>

<form id="sessionForm" action="/cgi-bin/python/session-form.py?action=save" method="post">
    <label>
        Field 1:
        <input type="text" name="field1">
    </label><br><br>

    <label>
        Field 2:
        <input type="text" name="field2">
    </label><br><br>

    <button type="submit">Save Data</button>
</form>

<h2>Response:</h2>
<pre id="responseOutput">No response yet.</pre>

<script>
const form = document.getElementById('sessionForm');
const output = document.getElementById('responseOutput');

form.addEventListener('submit', async (e) => {
    e.preventDefault();
    const data = new FormData(form);
    const params = new URLSearchParams();
    data.forEach((v,k) => params.append(k,v));

    const resp = await fetch(form.action, {
        method: 'POST',
        body: params
    });
    const text = await resp.text();
    output.textContent = text;
});
</script>

</body>
</html>
